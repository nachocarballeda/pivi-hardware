EESchema Schematic File Version 2
LIBS:power
LIBS:device
LIBS:transistors
LIBS:conn
LIBS:linear
LIBS:regul
LIBS:74xx
LIBS:cmos4000
LIBS:adc-dac
LIBS:memory
LIBS:xilinx
LIBS:microcontrollers
LIBS:dsp
LIBS:microchip
LIBS:analog_switches
LIBS:motorola
LIBS:texas
LIBS:intel
LIBS:audio
LIBS:interface
LIBS:digital-audio
LIBS:philips
LIBS:display
LIBS:cypress
LIBS:siliconi
LIBS:opto
LIBS:atmel
LIBS:contrib
LIBS:valves
LIBS:Allegro_ACS759
LIBS:acs712
LIBS:txs0104e
LIBS:less
LIBS:pivi-shield-cache
EELAYER 25 0
EELAYER END
$Descr A4 11693 8268
encoding utf-8
Sheet 1 20
Title "PIVI"
Date "Mon 27 Jul 2015"
Rev "2.0"
Comp "Copyright (C) LESS industries S.A. 2014,2015"
Comment1 "Share alike attribution non-commercial 4.0"
Comment2 "License: Creative Commons "
Comment3 "High level interconnection"
Comment4 ""
$EndDescr
Text Notes 2025 6825 0    60   ~ 0
RXD0
Text Notes 2025 6900 0    60   ~ 0
TXD0
Text Notes 1675 4225 0    120  ~ 0
Microcontroller Block
NoConn ~ 1350 7075
NoConn ~ 3750 7075
NoConn ~ 3750 6975
NoConn ~ 3750 6875
NoConn ~ 3750 6775
NoConn ~ 3750 6675
NoConn ~ 3750 6575
NoConn ~ 3750 6475
NoConn ~ 3750 6375
NoConn ~ 3750 5775
NoConn ~ 3750 5675
NoConn ~ 3750 5575
NoConn ~ 3750 4875
$Sheet
S 1750 4475 1600 2700
U 547008F6
F0 "Atxmega128a3 and support components 1" 50
F1 "ATXMEGA128A3U.sch" 50
F2 "PA0" I L 1750 4975 60 
F3 "PA1" I L 1750 5075 60 
F4 "PA2" I L 1750 5175 60 
F5 "PA3" I L 1750 5275 60 
F6 "PA4" I L 1750 5375 60 
F7 "PA5" I L 1750 5475 60 
F8 "PA6" I L 1750 5575 60 
F9 "PA7" I L 1750 5675 60 
F10 "PB0" I L 1750 5775 60 
F11 "PB1" I L 1750 5875 60 
F12 "PB2" I L 1750 5975 60 
F13 "PB3" I L 1750 6075 60 
F14 "PC0-I2C-SDA" I L 1750 6575 60 
F15 "PC1-I2C-SCL" I L 1750 6675 60 
F16 "PC2" I L 1750 6775 60 
F17 "PC3" I L 1750 6875 60 
F18 "PC4" I L 1750 6975 60 
F19 "PC5" I L 1750 7075 60 
F20 "PC6" I R 3350 7075 60 
F21 "PC7" I R 3350 6975 60 
F22 "PE0" I R 3350 6075 60 
F23 "PE1" I R 3350 5975 60 
F24 "PE2" I R 3350 5875 60 
F25 "PE3" I R 3350 5775 60 
F26 "PD0" I R 3350 6875 60 
F27 "PD1" I R 3350 6775 60 
F28 "PD2" I R 3350 6675 60 
F29 "PD3" I R 3350 6575 60 
F30 "PD4" I R 3350 6475 60 
F31 "PD5" I R 3350 6375 60 
F32 "PD6" I R 3350 6275 60 
F33 "PD7" I R 3350 6175 60 
F34 "PDI_DATA" I R 3350 4675 60 
F35 "PE4" I R 3350 5675 60 
F36 "PE5" I R 3350 5575 60 
F37 "PF0" I R 3350 5475 60 
F38 "PF1" I R 3350 5375 60 
F39 "PF2" I R 3350 5275 60 
F40 "PF3" I R 3350 5175 60 
F41 "PF4" I R 3350 5075 60 
F42 "PF5" I R 3350 4975 60 
F43 "PF6" I R 3350 4875 60 
F44 "PF7" I R 3350 4775 60 
F45 "PR0" I L 1750 6175 60 
F46 "PR1" I L 1750 6275 60 
F47 "RESET" I L 1750 4680 60 
$EndSheet
Text Label 1125 5175 0    60   ~ 0
Current_AD_2
Text Label 1125 5275 0    60   ~ 0
Current_AD_3
Text Label 1125 5375 0    60   ~ 0
Current_AD_4
Text Label 1135 5575 0    60   ~ 0
Current_AD_6
Text Label 1125 4975 0    60   ~ 0
Voltage_AD
$Comp
L +5V #PWR01
U 1 1 54928783
P 5850 1675
F 0 "#PWR01" H 5850 1765 20  0001 C CNN
F 1 "+5V" H 5850 1800 30  0000 C CNN
F 2 "" H 5850 1675 60  0000 C CNN
F 3 "" H 5850 1675 60  0000 C CNN
	1    5850 1675
	1    0    0    -1  
$EndComp
$Comp
L PWR_FLAG #FLG02
U 1 1 54928C31
P 5650 1750
F 0 "#FLG02" H 5650 1845 30  0001 C CNN
F 1 "PWR_FLAG" H 5650 1950 30  0000 C CNN
F 2 "" H 5650 1750 60  0000 C CNN
F 3 "" H 5650 1750 60  0000 C CNN
	1    5650 1750
	1    0    0    -1  
$EndComp
Text Notes 5250 1200 0    60   ~ 0
ERC power flags
$Sheet
S 1675 950  1775 2450
U 549598FF
F0 "Connectors" 60
F1 "pivi-connectors.sch" 60
F2 "SDA1" B L 1675 1450 60 
F3 "SCL1" I L 1675 1575 60 
F4 "TXD0" O L 1675 1700 60 
F5 "RXD0" I L 1675 1825 60 
F6 "CT1_DETECTOR" I L 1675 2225 60 
F7 "CT1_1" I R 3450 1200 60 
F8 "CT1_2" I R 3450 1325 60 
F9 "CT2_DETECTOR" I L 1675 2375 60 
F10 "CT2_1" I R 3450 1450 60 
F11 "CT2_2" I R 3450 1575 60 
F12 "CT3_DETECTOR" I L 1675 2525 60 
F13 "CT3_1" I R 3450 1700 60 
F14 "CT3_2" I R 3450 1825 60 
F15 "CT4_DETECTOR" I L 1675 2675 60 
F16 "CT4_1" I R 3450 1950 60 
F17 "CT4_2" I R 3450 2075 60 
F18 "CT5_DETECTOR" I L 1675 2825 60 
F19 "CT5_1" I R 3450 2200 60 
F20 "CT5_2" I R 3450 2325 60 
F21 "CT6_DETECTOR" I L 1675 2975 60 
F22 "CT6_1" I R 3450 2450 60 
F23 "CT6_2" I R 3450 2575 60 
F24 "Neutral_Line" O L 1675 1325 60 
F25 "GPIO-18" I R 3450 2850 60 
F26 "GPIO-23" I R 3450 2975 60 
F27 "Phase_Line" O L 1675 1200 60 
$EndSheet
$Sheet
S 5098 3478 1175 325 
U 548F00C8
F0 "5v_to_3.3v_LD0" 60
F1 "pivi-power-supply.sch" 60
$EndSheet
$Comp
L PWR_FLAG #FLG03
U 1 1 548F827F
P 5650 2000
F 0 "#FLG03" H 5650 2095 30  0001 C CNN
F 1 "PWR_FLAG" H 5650 2200 30  0000 C CNN
F 2 "" H 5650 2000 60  0000 C CNN
F 3 "" H 5650 2000 60  0000 C CNN
	1    5650 2000
	1    0    0    -1  
$EndComp
$Comp
L PWR_FLAG #FLG04
U 1 1 548F891D
P 5650 2250
F 0 "#FLG04" H 5650 2345 30  0001 C CNN
F 1 "PWR_FLAG" H 5650 2450 30  0000 C CNN
F 2 "" H 5650 2250 60  0000 C CNN
F 3 "" H 5650 2250 60  0000 C CNN
	1    5650 2250
	1    0    0    -1  
$EndComp
$Comp
L +3.3VADC #PWR05
U 1 1 548F9301
P 5850 1925
F 0 "#PWR05" H 5850 2045 20  0001 C CNN
F 1 "+3.3VADC" H 5875 2050 30  0000 C CNN
F 2 "" H 5850 1925 60  0000 C CNN
F 3 "" H 5850 1925 60  0000 C CNN
	1    5850 1925
	1    0    0    -1  
$EndComp
$Comp
L +3.3VP #PWR06
U 1 1 548F9315
P 5850 2175
F 0 "#PWR06" H 5900 2205 20  0001 C CNN
F 1 "+3.3VP" H 5850 2300 30  0000 C CNN
F 2 "" H 5850 2175 60  0000 C CNN
F 3 "" H 5850 2175 60  0000 C CNN
	1    5850 2175
	1    0    0    -1  
$EndComp
Text Notes 4725 1925 0    60   ~ 0
DC Analog +3,3v
Text Notes 4725 2200 0    60   ~ 0
DC Digital +3,3v\n(filter to uM)
Text Label 1075 1450 0    60   ~ 0
SDA1
Text Label 1200 6575 0    60   ~ 0
SDA1
Text Label 1075 1575 0    60   ~ 0
SCL1
Text Label 1200 6675 0    60   ~ 0
SCL1
Text Label 1075 1825 0    60   ~ 0
RXD0
Text Label 1075 1700 0    60   ~ 0
TXD0
Text Label 1200 6875 0    60   ~ 0
RXD0
Text Label 1200 6775 0    60   ~ 0
TXD0
$Comp
L PWR_FLAG #FLG07
U 1 1 5491BF45
P 6150 2600
F 0 "#FLG07" H 6150 2695 30  0001 C CNN
F 1 "PWR_FLAG" H 6150 2780 30  0000 C CNN
F 2 "" H 6150 2600 60  0000 C CNN
F 3 "" H 6150 2600 60  0000 C CNN
	1    6150 2600
	1    0    0    -1  
$EndComp
NoConn ~ 1350 6275
NoConn ~ 1350 6175
NoConn ~ 3750 6175
NoConn ~ 3750 6275
Text Label 6050 2600 2    39   ~ 0
Neutral_Filtered
$Comp
L INDUCTOR L1
U 1 1 54C2A183
P 6450 2050
F 0 "L1" V 6400 2050 40  0000 C CNN
F 1 "1u" V 6550 2050 40  0000 C CNN
F 2 "Inductors_NEOSID:Neosid_Inductor_SM-NE30_SMD1210" V 6675 2050 60  0001 C CNN
F 3 "" H 6450 2050 60  0000 C CNN
	1    6450 2050
	1    0    0    -1  
$EndComp
$Comp
L GND #PWR08
U 1 1 54BFB838
P 6150 2600
F 0 "#PWR08" H 6150 2350 60  0001 C CNN
F 1 "GND" H 6150 2450 60  0000 C CNN
F 2 "" H 6150 2600 60  0000 C CNN
F 3 "" H 6150 2600 60  0000 C CNN
	1    6150 2600
	1    0    0    -1  
$EndComp
Text Label 6450 1500 2    39   ~ 0
Neutral_Line
$Sheet
S 7930 2365 1715 2930
U 548DF2C8
F0 "measurement circuits" 60
F1 "measurement_circuits.sch" 60
F2 "CT1_1" I L 7930 3025 60 
F3 "CT1_2" I L 7930 3200 60 
F4 "CURRENT_AD_1" I R 9645 2850 60 
F5 "CT2_1" I L 7930 3380 60 
F6 "CT2_2" I L 7930 3555 60 
F7 "CT3_1" I L 7930 3735 60 
F8 "CT3_2" I L 7930 3920 60 
F9 "CT4_1" I L 7930 4120 60 
F10 "CT4_2" I L 7930 4295 60 
F11 "CT5_1" I L 7930 4465 60 
F12 "CT5_2" I L 7930 4665 60 
F13 "CT6_1" I L 7930 4855 60 
F14 "CT6_2" I L 7930 5030 60 
F15 "CURRENT_AD_2" I R 9645 3035 60 
F16 "CURRENT_AD_3" I R 9645 3215 60 
F17 "CURRENT_AD_4" I R 9645 3410 60 
F18 "CURRENT_AD_5" I R 9645 3605 60 
F19 "CURRENT_AD_6" I R 9645 3800 60 
F20 "Neutral_Filtered" I L 7930 2840 60 
F21 "Phase_Line" I L 7930 2655 60 
F22 "Voltage_AD_1" I R 9645 3975 60 
F23 "Voltage_AD_2" I R 9645 4150 60 
F24 "Voltage_AD_3" I R 9645 4350 60 
$EndSheet
Text Label 1125 5075 0    60   ~ 0
Current_AD_1
Text Label 1130 5475 0    60   ~ 0
Current_AD_5
NoConn ~ 1350 6075
NoConn ~ 1350 5975
Text Label 1075 1200 0    60   ~ 0
Phase_Line
Wire Wire Line
	1350 7075 1750 7075
Wire Wire Line
	1200 6975 1750 6975
Wire Wire Line
	1135 5575 1750 5575
Wire Wire Line
	1200 6575 1750 6575
Wire Wire Line
	1750 6675 1200 6675
Wire Wire Line
	1200 6775 1750 6775
Wire Wire Line
	1750 6875 1200 6875
Wire Wire Line
	3750 7075 3350 7075
Wire Wire Line
	3750 6975 3350 6975
Wire Wire Line
	3750 6875 3350 6875
Wire Wire Line
	3750 6775 3350 6775
Wire Wire Line
	3750 6675 3350 6675
Wire Wire Line
	3750 6575 3350 6575
Wire Wire Line
	3750 6475 3350 6475
Wire Wire Line
	3750 6375 3350 6375
Wire Wire Line
	3750 6275 3350 6275
Wire Wire Line
	3750 6175 3350 6175
Wire Wire Line
	3750 5775 3350 5775
Wire Wire Line
	3750 5675 3350 5675
Wire Wire Line
	3750 5575 3350 5575
Wire Wire Line
	3350 5475 4065 5475
Wire Wire Line
	3350 5375 4065 5375
Wire Wire Line
	3350 5275 4065 5275
Wire Wire Line
	3350 5175 4065 5175
Wire Wire Line
	3350 5075 4065 5075
Wire Wire Line
	3350 4975 4065 4975
Wire Wire Line
	3750 4875 3350 4875
Wire Wire Line
	3750 4775 3350 4775
Wire Wire Line
	3750 4675 3350 4675
Wire Wire Line
	1750 4975 1125 4975
Wire Wire Line
	1750 5075 1125 5075
Wire Wire Line
	1750 5175 1125 5175
Wire Wire Line
	1750 5275 1125 5275
Wire Wire Line
	1750 5375 1125 5375
Wire Wire Line
	5650 1750 5850 1750
Wire Wire Line
	5850 1750 5850 1675
Wire Wire Line
	5650 2000 5850 2000
Wire Wire Line
	5850 2000 5850 1925
Wire Wire Line
	5650 2250 5850 2250
Wire Wire Line
	5850 2250 5850 2175
Wire Wire Line
	3450 2075 4075 2075
Wire Wire Line
	3450 1950 4075 1950
Wire Wire Line
	3450 1575 4075 1575
Wire Wire Line
	3450 1700 4075 1700
Wire Notes Line
	6600 1250 6600 2900
Wire Notes Line
	6600 2900 4650 2900
Wire Notes Line
	4650 2900 4650 1250
Wire Notes Line
	4650 1250 6600 1250
Wire Wire Line
	1350 6275 1750 6275
Wire Wire Line
	1350 6175 1750 6175
Wire Wire Line
	6050 2600 6450 2600
Wire Wire Line
	6450 2600 6450 2350
Wire Wire Line
	6450 1750 6450 1500
Connection ~ 6150 2600
Wire Wire Line
	1750 5475 1130 5475
Wire Wire Line
	1350 6075 1750 6075
Wire Wire Line
	1350 5975 1750 5975
Wire Wire Line
	1130 5875 1750 5875
Wire Wire Line
	1135 5675 1750 5675
Wire Wire Line
	3450 1200 4075 1200
Wire Wire Line
	3450 1325 4075 1325
Wire Wire Line
	3450 2325 4075 2325
Wire Wire Line
	3450 2450 4075 2450
Wire Wire Line
	3450 1450 4075 1450
Wire Wire Line
	3450 1825 4075 1825
Wire Wire Line
	3450 2200 4075 2200
Wire Wire Line
	3450 2575 4075 2575
Wire Wire Line
	1675 1200 1075 1200
Wire Wire Line
	1675 1325 1075 1325
Wire Wire Line
	1675 1450 1075 1450
Wire Wire Line
	1675 1575 1075 1575
Wire Wire Line
	1075 1700 1675 1700
Wire Wire Line
	1675 1825 1075 1825
Wire Wire Line
	1675 2225 1075 2225
Wire Wire Line
	1075 2375 1675 2375
Wire Wire Line
	1675 2525 1075 2525
Wire Wire Line
	1675 2675 1075 2675
Wire Wire Line
	1675 2825 1075 2825
Wire Wire Line
	1675 2975 1075 2975
Text Label 10345 3975 2    60   ~ 0
Voltage_AD_1
Wire Wire Line
	9645 3975 10345 3975
Wire Wire Line
	9645 2850 10345 2850
Wire Wire Line
	9645 3035 10345 3035
Wire Wire Line
	9645 3215 10345 3215
Wire Wire Line
	9645 3410 10345 3410
Wire Wire Line
	9645 3605 10345 3605
Wire Wire Line
	9645 3800 10345 3800
Wire Wire Line
	7230 4855 7930 4855
Wire Wire Line
	7230 5030 7930 5030
Wire Wire Line
	7230 4665 7930 4665
Wire Wire Line
	7230 4465 7930 4465
Wire Wire Line
	7230 4120 7930 4120
Wire Wire Line
	7230 3920 7930 3920
Wire Wire Line
	7230 3555 7930 3555
Wire Wire Line
	7230 3735 7930 3735
Wire Wire Line
	7230 3380 7930 3380
Wire Wire Line
	7230 3200 7930 3200
Wire Wire Line
	7230 3025 7930 3025
Wire Wire Line
	7230 2840 7930 2840
Wire Wire Line
	7230 2655 7930 2655
Wire Wire Line
	7230 4295 7930 4295
Text Label 4075 1200 2    60   ~ 0
CT1_1
Text Label 4075 1325 2    60   ~ 0
CT1_2
Text Label 4075 1450 2    60   ~ 0
CT2_1
Text Label 4075 1575 2    60   ~ 0
CT2_2
Text Label 4075 1700 2    60   ~ 0
CT3_1
Text Label 4075 1825 2    60   ~ 0
CT3_2
Text Label 4075 1950 2    60   ~ 0
CT4_1
Text Label 4075 2075 2    60   ~ 0
CT4_2
Text Label 4075 2200 2    60   ~ 0
CT5_1
Text Label 4075 2325 2    60   ~ 0
CT5_2
Text Label 4075 2450 2    60   ~ 0
CT6_1
Text Label 4075 2575 2    60   ~ 0
CT6_2
Text Label 7230 3025 0    60   ~ 0
CT1_1
Text Label 7230 3200 0    60   ~ 0
CT1_2
Text Label 7230 3380 0    60   ~ 0
CT2_1
Text Label 7230 3555 0    60   ~ 0
CT2_2
Text Label 7230 3735 0    60   ~ 0
CT3_1
Text Label 7230 3920 0    60   ~ 0
CT3_2
Text Label 7230 4120 0    60   ~ 0
CT4_1
Text Label 7230 4295 0    60   ~ 0
CT4_2
Text Label 7230 4465 0    60   ~ 0
CT5_1
Text Label 7230 4665 0    60   ~ 0
CT5_2
Text Label 7230 4855 0    60   ~ 0
CT6_1
Text Label 7230 5030 0    60   ~ 0
CT6_2
Text Label 7230 2655 0    60   ~ 0
Phase_Line
Text Label 7230 2840 0    59   ~ 0
Neutral_Filtered
Text Label 1075 1325 0    60   ~ 0
Neutral_Line
Text Label 10345 3035 2    60   ~ 0
Current_AD_2
Text Label 10345 3215 2    60   ~ 0
Current_AD_3
Text Label 10345 3410 2    60   ~ 0
Current_AD_4
Text Label 10345 3800 2    60   ~ 0
Current_AD_6
Text Label 10345 2850 2    60   ~ 0
Current_AD_1
Text Label 10345 3605 2    60   ~ 0
Current_AD_5
Text Label 1075 2225 0    60   ~ 0
CT1_Detector
Text Label 1075 2375 0    60   ~ 0
CT2_Detector
Text Label 1075 2525 0    60   ~ 0
CT3_Detector
Text Label 1075 2675 0    60   ~ 0
CT4_Detector
Text Label 1075 2825 0    60   ~ 0
CT5_Detector
Text Label 1075 2975 0    60   ~ 0
CT6_Detector
Text Label 4065 5375 2    60   ~ 0
CT2_Detector
Text Label 4065 5275 2    60   ~ 0
CT3_Detector
Text Label 4065 5175 2    60   ~ 0
CT4_Detector
Text Label 4065 5075 2    60   ~ 0
CT5_Detector
Text Label 4065 4975 2    60   ~ 0
CT6_Detector
NoConn ~ 3750 4775
NoConn ~ 3750 4675
Text Label 4065 5475 2    60   ~ 0
CT1_Detector
NoConn ~ 3750 6075
NoConn ~ 3750 5875
NoConn ~ 3750 5975
Wire Wire Line
	3750 6075 3350 6075
Wire Wire Line
	3750 5975 3350 5975
Wire Wire Line
	3750 5875 3350 5875
Text Label 1200 6975 0    60   ~ 0
Control
Wire Wire Line
	3450 2975 4070 2975
Wire Wire Line
	3450 2850 4070 2850
Text Label 4070 2975 2    60   ~ 0
Control
Wire Wire Line
	1750 4680 1120 4680
Text Label 1120 4680 0    60   ~ 0
RESET
Text Label 4070 2850 2    60   ~ 0
RESET
Text Label 10345 4150 2    60   ~ 0
Voltage_AD_2
Wire Wire Line
	9645 4150 10345 4150
Text Label 10345 4350 2    60   ~ 0
Voltage_AD_3
Wire Wire Line
	9645 4350 10345 4350
Text Label 1135 5675 0    60   ~ 0
Voltage_AD_1
Text Label 1130 5775 0    60   ~ 0
Voltage_AD_2
Text Label 1130 5875 0    60   ~ 0
Voltage_AD_3
Wire Wire Line
	1750 5775 1130 5775
$EndSCHEMATC
